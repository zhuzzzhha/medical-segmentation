# medical-segmentation

## Применение
Сегментация дерева дыхательных путей с помощью торакальной компьютерной томографии (КТ) является полезной процедурой для оценки легочных заболеваний, характеризующихся структурными аномалиями дыхательных путей, таких как бронхоэктатическая болезнь (расширение дыхательных путей) и утолщение стенки дыхательных путей.
## Дыхательные пути на снимках
На компьютерной томографии дыхательные пути выглядят как трубчатые структуры, внутренняя часть которых обычно имеет низкую интенсивность (просвет), окруженная структурой более высокой интенсивности (стенка дыхательных путей). Кроме того, дыхательные пути окружены фоном, который может быть низкой интенсивности (паренхима легких) или высокой интенсивности (обычно сосуды).
## Automatic airway segmentation from computed tomography using robust and efficient 3-D convolutional neural networks
Сегментация дыхательных путей с пощью U-net.
### Датасеты:
1) набор данных педиатрических пациентов, включая пациентов с муковисцидозом
2) подгруппа датского исследования по скринингу рака легких, включая пациентов с хронической обструктивной легочной недостаточностью
3) EXACT'09

### Loss
Soft Dice

### Оценка качества
1. Tree length - процент centerline вокселей, находящихся внутри предсказаний от эталонной полной длины осевой линии.
2. Centerline leakage - процент centerline вокселей, находящихся снаружи предсказаний от эталонной полной длины осевой линии.
3. FPR
4. Dice coefficient $$DSC = \frac{2|P \cap G|}{|P| + |G|}$$
5. Total tree length - сумма основных вокселей осевой линии, которые находятся внутри прогнозов, умноженная на коэффициент, представляющий разрешение воксела (мы использовали среднее геометрическое размеров вокселей в трех измерениях)

Чтобы сравнить эффективность различных методов, мы использовали парный двусторонний Т-критерий Стьюдента для измерения эффективности на тестовом наборе. Чтобы сравнить точность нашего метода на основе U-Net между здоровыми и больными субъектами, мы использовали непарный двусторонний Т-критерий Стьюдента для показателей двух групп. Мы считаем, что значение p ниже 0,01 указывает на то, что два сравниваемых набора показателей существенно различаются.

### Гиперпараметры
- количество resolution levels в U-Net = 5;
- количество feature maps в первом слое = 16;
- размер входного изображения  = 252 x 252 x 252;
- batch size = 1 изображение.

### Код
https://github.com/antonioguj/bronchinet

### Преимущества метода
Предлагаемый метод на основе U-Net обрабатывает большие трехмерные участки, извлеченные из компьютерной томографии, за один проход через сеть. Это делает метод простым, надежным и эффективным во время вывода, поскольку для сегментации полного сканирования обрабатывается только несколько крупных участков. Хотя обработка больших входных патчей не обязательно подразумевает повышение производительности, мы заметили, что использование больших входных патчей приводит к лучшим результатам и более быстрой сходимости потерь при обучении и проверке. Вероятно, это связано с более эффективным использованием данных во время обучения. Напротив, при использовании меньших патчей для обучения модели требуется выборка патчей в каждом вокселе для одинаковой обработки одной и той же области КТ-сканирования, содержащейся в более крупном патче, что приводит к большому количеству общих патчей.

### Недостатки
Ограничением метода на основе U-Net является то, что прогнозирование выходных данных дерева дыхательных путей не гарантирует формирования связной древовидной структуры. Это может усложнить автоматическое извлечение биомаркеров дыхательных путей на основе этих сегментаций, поскольку некоторые методы предполагают в качестве входных данных полностью связное дерево. Прогнозы дыхательных путей, полученные для этой статьи, обычно включали некоторые сегментированные периферические дыхательные пути, отключенные от основного дерева дыхательных путей, и они были отброшены при вычислении самого большого связного компонента, что уменьшало полноту нашей сегментации дыхательных путей.

### Оптимизации
При анализе 3D-сканирований грудной клетки мы обнаружили, что основным узким местом является объем памяти сети. Чтобы облегчить эту проблему, мы используем свертки без padding на первых трех уровнях разрешения U-Net, где крайние слои вокселей в картах объектов постепенно удаляются после каждой свертки. Мы по-прежнему используем заполнение нулями на остальных уровнях после третьего, чтобы предотвратить чрезмерное уменьшение выходного размера сети. Это позволяет уменьшить объем памяти примерно на (30 %) по сравнению с моделью с заполнением нулями во всех слоях. Более того, мы не используем слои исключения или пакетной нормализации, поскольку они требуют дополнительной памяти для хранения карт объектов после операции.

## A data-centric deep learning approach to airway segmentation
### Метод
Использовался расширенный Unet —  расширенная модель оригинального Unet с архитектурой кодера-декодера. Путь кодирования захватывает функции из изображений, а путь декодирования локализует эти функции. Последовательный модуль расширения используется на уровне «узких мест», и это улучшает глобальный контекст.

## Loss
Комбинированная функция потерь включает в себя двоичную перекрестную энтропию (BCE) и Dice. BCE используется для расчета разницы между двумя распределениями вероятностей (передний план против фона). DSC используется для измерения сходства между предсказанными и эталоном.
Focal loss обычно используется для борьбы с классовым дисбалансом. Он обобщает BCE и параметр фокусировки, гамма, введен для более строгого наказания за образцы, которые трудно классифицировать.
относительно легко классифицируемых образцов.

### Learning Bronchiole-Sensitive Airway Segmentation CNNs by Feature Recalibration and Attention Distillation
Используется расширенная U-net. Добавлены 4 pooling слоя, на каждом масштабе и энкодер и декодер имеют 2 сверточных слоя, за которыми следуют нормализация. Перекалибровка и дистилляция внимания

### Loss
Focal loss, Dice

### Датасет
- 70 scans from LIDC
- 20 scans from the training set of EXACT’09
### Функции оценки качества
- Branches detected (BD)
- Tree-length detected (TD)
- True positive rate (TPR)
- False positive rate (FPR)
- Dice coefficient (DSC)
